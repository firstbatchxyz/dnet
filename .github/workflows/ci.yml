name: CI

# NOTE: This workflow requires an SSH key to access private submodules.
# Generate an SSH key and add it as a deploy key to each submodule repository,
# then add the private key as a secret named 'CI_SSH_KEY'.

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

# Cancel in-progress runs when a new commit is pushed to the same branch/PR
concurrency:
  group: ${{ github.workflow }}-${{ github.event.pull_request.number || github.ref }}
  cancel-in-progress: true

jobs:
  matrix-checks:
    uses: ./.github/workflows/matrix-checks.yml
    secrets: inherit
    with:
      python_version: '3.12'

  tests-macos:
    uses: ./.github/workflows/tests-macos.yml
    secrets: inherit
    with:
      python_version: '3.12'
